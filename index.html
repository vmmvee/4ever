<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>My Special Website for Dina</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: 'Comic Sans MS', cursive, sans-serif;
      height: 100vh;
      background: black;
      overflow: hidden;
    }

    .centered {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
      color: white;
      position: relative;
    }

    .start-button {
      position: absolute;
      top: 58%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 180px;
      height: 60px;
      background-color: transparent;
      border: none;
      cursor: pointer;
      z-index: 10;
    }

    .main-content {
      display: none;
      background: url('https://i.pinimg.com/originals/5e/b1/7c/5eb17c4f17211055c1b9be88c4703953.gif') no-repeat center center fixed;
      background-size: cover;
      height: 100vh;
      width: 100vw;
      color: white;
    }

    .logo {
      margin-bottom: 40px;
      margin-top: -160px;
      width: 100%;
      max-width: 750px;
      animation: fadeIn 1.5s ease;
      position: relative;
      z-index: 5;
    }

    .fade {
      opacity: 0;
      transition: opacity 1s ease-in-out;
    }

    .fade.show {
      opacity: 1;
    }

    .background-img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: 0;
    }

    canvas {
      position: absolute;
      top: 0;
      left: 0;
      z-index: 4;
      pointer-events: auto;
    }
  </style>
</head>
<body>

  <!-- شاشة البداية -->
  <div class="centered fade show" id="start-screen">
    <img src="https://raw.githubusercontent.com/vmmvee/jpg/refs/heads/main/Picsart_25-04-18_02-19-49-246.jpg" class="background-img" alt="Background"/>
    <button class="start-button" onclick="startSite()"></button>
  </div>

  <!-- المحتوى الرئيسي -->
  <div class="main-content fade" id="main-content">
    <div class="input-container">
      <img id="eye-img" src="https://raw.githubusercontent.com/vmmvee/jpg/refs/heads/main/Picsart_25-04-20_17-28-36-831%5B1%5D.png" alt="Eye" class="logo"/>
    </div>
  </div>

  <!-- الصوت -->
  <audio id="audio" loop>
    <source src="https://www.dropbox.com/scl/fi/li3f5xmoh3qa7r3nkgehd/A-new-song-by-me-_D-originalsound-music-piano-space-animated-pixel-pixelart-originalmusic.mp3?rlkey=t3q398qcrgeenulc3yiguyzjr&st=53mayfgb&raw=1" type="audio/mp3">
  </audio>

  <!-- مكتبة التعرف على الرسم -->
  <script>
    class DollarRecognizer {
      constructor() {
        this.templates = [];
        this.addGesture("D", [[0,0],[0,50],[0,100],[25,100],[50,75],[50,25],[25,0],[0,0]]);
      }

      addGesture(name, points) {
        this.templates.push({ name, points });
      }

      recognize(points) {
        let minDistance = Infinity, matched = null;
        for (const template of this.templates) {
          const d = this.greedyMatch(points, template.points);
          if (d < minDistance) {
            minDistance = d;
            matched = template.name;
          }
        }
        return matched;
      }

      greedyMatch(a, b) {
        let sum = 0;
        for (let i = 0; i < Math.min(a.length, b.length); i++) {
          const dx = a[i][0] - b[i][0];
          const dy = a[i][1] - b[i][1];
          sum += dx * dx + dy * dy;
        }
        return sum;
      }
    }

    const recognizer = new DollarRecognizer();
  </script>

  <!-- رسم وتفاعل -->
  <script>
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    let drawing = false;
    let path = [];

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    document.body.appendChild(canvas);

    function isInEyeZone(x, y) {
      const eye = document.getElementById("eye-img").getBoundingClientRect();
      return x >= eye.left && x <= eye.right && y >= eye.top && y <= eye.bottom;
    }

    function getTouchCoordinates(e) {
      if (e.touches) {
        return [e.touches[0].clientX, e.touches[0].clientY];
      } else {
        return [e.clientX, e.clientY];
      }
    }

    canvas.addEventListener("mousedown", (e) => {
      if (!isInEyeZone(e.clientX, e.clientY)) {
        drawing = true;
        path = [[e.clientX, e.clientY]];
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.moveTo(e.clientX, e.clientY);
      }
    });

    canvas.addEventListener("mousemove", (e) => {
      if (drawing && !isInEyeZone(e.clientX, e.clientY)) {
        const [x, y] = getTouchCoordinates(e);
        path.push([x, y]);
        ctx.lineTo(x, y);
        ctx.strokeStyle = "#ff80d5";
        ctx.lineWidth = 5;
        ctx.stroke();
      }
    });

    canvas.addEventListener("mouseup", () => {
      drawing = false;
      if (path.length > 5) {
        const result = recognizer.recognize(resample(path, 32));
        if (result === "D") {
          window.location.href = "mainpage.html";
        } else {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
      }
    });

    // دعم لللمس
    canvas.addEventListener("touchstart", (e) => {
      const [x, y] = getTouchCoordinates(e);
      if (!isInEyeZone(x, y)) {
        drawing = true;
        path = [[x, y]];
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.beginPath();
        ctx.moveTo(x, y);
      }
    });

    canvas.addEventListener("touchmove", (e) => {
      e.preventDefault(); // لمنع التمرير أثناء الرسم
      if (drawing) {
        const [x, y] = getTouchCoordinates(e);
        path.push([x, y]);
        ctx.lineTo(x, y);
        ctx.strokeStyle = "#ff80d5";
        ctx.lineWidth = 5;
        ctx.stroke();
      }
    });

    canvas.addEventListener("touchend", () => {
      drawing = false;
      if (path.length > 5) {
        const result = recognizer.recognize(resample(path, 32));
        if (result === "D") {
          window.location.href = "mainpage.html";
        } else {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        }
      }
    });

    function resample(path, n) {
      const I = pathLength(path) / (n - 1);
      let D = 0, newPoints = [path[0]];
      for (let i = 1; i < path.length; i++) {
        const d = distance(path[i-1], path[i]);
        if ((D + d) >= I) {
          const qx = path[i-1][0] + ((I - D) / d) * (path[i][0] - path[i-1][0]);
          const qy = path[i-1][1] + ((I - D) / d) * (path[i][1] - path[i-1][1]);
          newPoints.push([qx, qy]);
          path.splice(i, 0, [qx, qy]);
          D = 0;
        } else {
          D += d;
        }
      }
      while (newPoints.length < n) newPoints.push(path[path.length - 1]);
      return newPoints;
    }

    function distance(a, b) {
      return Math.hypot(a[0] - b[0], a[1] - b[1]);
    }

    function pathLength(pts) {
      let d = 0;
      for (let i = 1; i < pts.length; i++) {
        d += distance(pts[i - 1], pts[i]);
      }
      return d;
    }

    function startSite() {
      const startScreen = document.getElementById("start-screen");
      const mainContent = document.getElementById("main-content");
      const audio = document.getElementById("audio");

      startScreen.classList.remove("show");
      setTimeout(() => {
        startScreen.style.display = "none";
        mainContent.style.display = "block";
        requestAnimationFrame(() => mainContent.classList.add("show"));
      }, 1000);

      audio.play();
    }
  </script>

</body>
</html>

